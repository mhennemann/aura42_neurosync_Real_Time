<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeuroSync Avatar Chat</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="chat-panel">
        <!-- In templates/index.html den header-Bereich ersetzen -->
        <div class="header">
            <div class="logo">NS</div> <!-- Ihr Logo Placeholder -->
            <h1>🎯 NeuroSync Avatar Chat</h1>
            <p>Professioneller KI-Avatar mit ElevenLabs TTS & Franzi</p>
        </div>

        <div class="chat-messages" id="chatMessages">
            <div class="message avatar-message">
                <strong>Avatar</strong>
                Hallo! Ich bin dein KI-Avatar mit NeuroSync und ElevenLabs. Schreibe eine Nachricht oder nutze das Mikrofon zum Chatten!
                <small>Bereit zum Chatten</small>
            </div>
        </div>

        <div class="input-area">
            <input type="text" id="textInput" placeholder="Schreibe deine Nachricht hier..." />
            <button onclick="sendMessage()">Senden</button>
        </div>

        <div class="controls">
            <button id="micButton" class="mic-button" onclick="toggleRecording()">🎤 Aufnehmen</button>
            <button onclick="clearChat()">Chat löschen</button>
        </div>
        <!-- In templates/index.html nach den <div class="controls"> einfügen -->
        <div class="sync-controls">
            <label for="audioDelaySlider">🎵 Audio-Sync Delay:</label>
            <input type="range" id="audioDelaySlider" min="0" max="200" value="40" step="10">
            <span id="delayValue">40ms</span>
            <button onclick="testSync()" id="testSyncBtn">🔄 Test Sync</button>
        </div>

        <div class="status" id="status">
            Bereit • ElevenLabs + NeuroSync System verbunden
        </div>
    </div>

    <div class="avatar-panel">
        <div class="avatar-header">
            <h2>🤖 Live Avatar</h2>
            <p>NeuroSync Pixel Streaming</p>
        </div>

        <!-- PIXEL STREAMING IFRAME -->
        <div class="pixel-stream-container">
            <iframe id="pixelStreamIframe"
                    src="https://avatar.aura42.de/"
                    width="100%"
                    height="100%"
                    frameborder="0"
                    allow="microphone; camera; autoplay">
            </iframe>
        </div>

        <div class="avatar-controls">
            <button onclick="toggleStream()">📹 Stream Toggle</button>
            <button onclick="resetStream()">🔄 Reset</button>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>